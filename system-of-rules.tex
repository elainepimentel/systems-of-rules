\documentclass{llncs}
\usepackage{xspace}
\usepackage{proof}
\usepackage{xcolor}
\usepackage{amsmath}
\usepackage{leftidx}
\usepackage{cmll}
\usepackage{amssymb}
\usepackage{graphicx} % for rotatebox
\usepackage{rotating}
\usepackage{subcaption}
%\usepackage[hide]{ed}
\usepackage[show]{ed}
\usepackage[colorlinks,linkcolor=blue,citecolor=blue]{hyperref}
\usepackage{xifthen}

\usepackage{collectbox}

\makeatletter
\newcommand{\mybox}{%
    \collectbox{%
        \setlength{\fboxsep}{1pt}%
        \fbox{\BOXCONTENT}%
    }%
}
\makeatother

\bibliographystyle{alpha}
\input{phead.tex}

\title{Systems of rules}

\author{Draft}
\institute{\today}
%\address{Dept. of Computer Science, University College London, UK}
%\date{\vskip-20pt\noindent Original version: November 2021}


\begin{document}
\maketitle

\begin{abstract}
In these notes we will briefly explain focusing, the axioms-as-rules approach and its possible application to systems of rules.
\end{abstract}

\section{What is focusing?}
Suppose that, in intuitionistic logic, we would like to try to prove the following sequent in intuitionistic logic
\[
A\iimp B, C\wedge D\seq p
\]
where $p$ is an atomic formula. There are two ways of proceeding with proof search (hence in a bottom-up reading of rules): either apply the conjunction left rule or the implication left rule.
%many ways of doing so. For example, we could start by applying a rule over the main connective of $F$, or one of the formulas in $\Gamma$, if they exist. Another possibility would be start with 

If we decide for the first, assuming (the multiplicative version of) the conjunction left rule, the derivation would look like
\[
\infer[\wedge_{l_M}]{A\iimp B, C\wedge D\seq p}
{\deduce{A\iimp B, C, D\seq p}{
\deduce{}{\vdots}}}
\] 
Since $(\wedge_{l_M})$ is an invertible rule~\cite{troelstra00book}, its application does not affect provability in the sense that, if the conclusion is provable, so is the premise.

Now, if instead we decide to apply the left rule for implication\footnote{We will avoid the discussion on copying the  implication to the left premise here. See~\cite{DBLP:journals/jsyml/Dyckhoff92}.}
\[
\infer[\iimp_{l}]{A\iimp B, C\wedge D\seq p}{C\wedge D\seq A & B, C\wedge D\seq p}
\] 
then provability may be lost, since $(\iimp_{l})$ is not invertible w.r.t. the left premise, that is, it may be the case that the conclusion sequent is provable but the left premise sequent is not.

Hence, when  searching for a proof of $A\iimp B, C\wedge D\seq p$ we can {\em always} start by applying the $(\wedge_{l_M})$ --  {\em don't care non-determinism} -- postponing making decisions, like applying $(\iimp_{l})$, until there are no more invertible options left. At that point, a decision has to be made: which non-invertible step should be taken --  {\em don't know non-determinism}. 

This is the essence of focusing~\cite{andreoli92jlc}: separate the proof steps into unfocused (no changes in provability) and focused (decisions must be made). In the focused step, once we decide to {\em focus on} (or work on) a formula, this focus is maintained, bottom-up, after the application of the rule. We mark the focused formulas with the downarrow symbol $\Downarrow$. The focused left rule for the implication is
\[
\infer[\iimp_{l}]{\jLf{\Gamma}{A\iimp B}{C}}{\jRf{\Gamma}{A}{} & \jLf{\Gamma}{B}{C}}
\] 
We read this as: if we decide to decompose $A\iimp B$ on the left, we should continue the proof search by maintaining the focus  on $A$ on the right and $B$ on the left.

But what about {\em atomic formulas}? Suppose that $A,B$ are atomic formulas in the focused derivation above. It is
        possible to impose two different ``protocols'' for dealing with the atomic case.  The $Q$-protocol insists that the left premise above is trivial, meaning that it is proved by
        the initial rule.  On the other hand, focusing should be lost (represented by the uparrow $\Uparrow$) in the right premise
\[
\infer[\iimp_{l}]{\jLf{\Gamma}{A\iimp B}{C}}
{\infer[\kinit]{\jRf{\Gamma}{A}{}}{} & 
\infer{\jLf{\Gamma}{B}{C}}{\jUnf{\Gamma}{B}{C}{}}}
\]  
        Following that protocol, we have that it should be the case that
        $A\in\Gamma$.  Thus, if we set $\Gamma'$
        to be the result of removing all occurrences of $A$
        from $\Gamma$, then the (unfocused) derived inference rule from the derivation above becomes
\[
  \infer[\iimp_{l_Q}]
        {\Gamma', A, A\iimp B \seq C}
        {\Gamma' , B\seq C}
\]
        The second protocol, the $T$-protocol, insists that the right-most
        premise is trivial and focus should be lost in the left premise
\[
\infer[\iimp_{l}]{\jLf{\Gamma}{A\iimp B}{C}}
{\infer{\jRf{\Gamma}{A}{}}{\jUnf{\Gamma}{}{A}{}} & 
\infer[\kinit]{\jLf{\Gamma}{B}{C}}{}}
\]   
That is,
        $B$ and $C$ are the same atomic formula.       
Thus,  the (unfocused) derived inference rule from the derivation above becomes
\[
  \infer[\iimp_{l_T}]
        {\Gamma, A\iimp B \seq B}
        {\Gamma \seq A}
\]
The names for the $Q$ and $T$ protocols comes from Danos, Joinet, and
Schellinx~\cite{danos93wll}: in the $Q$ protocol, the tail (``queue'')
of an implication yields a trivial premise while in the $T$ protocol,
the head (``t\^ete'') of an implication yields a trivial premise.

A more modern and flexible presentation of the $Q$ and $T$ protocols
speaks, instead, of the \emph{polarity} of formulas.
%
In particular, if all atomic formulas have a {\em positive polarity}, the
$Q$-protocol is enforced, while if all atomic formulas have a {\em negative
polarity}, the $T$-protocol is enforced.

Now that focusing is understood for implication and atoms, what can be said about the other connectives? For example, in the case of conjunction, we adopted the (invertible) {\em multiplicative version} of the left rule, that is
\[
\infer[\wedge_{l_M}]{\Gamma, A\wedge B\seq C}{\Gamma, A, B\seq C}
\] 
This rule incorporates the left contraction rule. Gentzen's original rules correspond to the (non-invertible) {\em additive version}, where a choice has to be made during proof search
\[
 \infer[\wedge_{l_{i}}]{A_1\wedge A_2, \Gamma \seq C}{A_i, \Gamma \seq C}
\]
Such multiplicative/additive, invertible/non-invertible flavors can be captured in a single proof system by splitting the conjunction into two connectives: 
$\wedgep$ and $\wedgen$, with {\em unfocused/focused} left rules 
%Of course we have $A\wedgen B$ is logically equivalent to $A\wedgep B$, so while provability is maintained, the form of the resulting proofs can be completely different.
\[
  \infer[\wedgep_{l}]{\jUnf{\Gamma}{A\wedgep B,\Theta}{}{C}}{\jUnf{\Gamma}{A , B, \Theta}{}{C}}
  \qquad
 \infer[\wedgen_{l_i}]{\jLf{\Gamma}{A_1 \wedgen A_2}{C}}{\jLf{\Gamma}{A_i}{C}}
 \]


In \cite{liang07csl,LiaMil09} Miller and Liang proposed the  \LKF and \LJF focused proof
systems for classical and intuitionistic logics, respectively.
%
Those systems 
extend both the notion of focusing and polarity to
all formulas. 

In such systems, {\em focused rule applications} imply that focus is transferred from conclusion to premises in derivations. This process goes on until either the focused phase ends (depending on the {\em polarity} of the focused formula), or the derivation ends.
Once the focus is \emph{released}, the formula is eagerly decomposed into subformulas, which are ultimately {\em stored} in the context. 
%
We will describe this in detail in the next section.

{\em Some historical remarks.} The focusing discipline is based on the notion of {\em uniform proofs}~\cite{miller91apal} and it was discovered by Andreoli in~\cite{andreoli92jlc}, who showed that it is complete for linear logic~\cite{DBLP:journals/tcs/Girard87}, which naturally contains the multiplicative and additive versions of disjunction and conjunction. In intuitionistic logic focusing gives rise to  call-by-value~\cite{dyckhoff06cie}  and call-by-name~\cite{herbelin94csl} calculi, since using the $Q$-protocol the proof-search semantics of the
implication is given by 
\emph{forward-chaining}, while using the $T$-protocol, the proof-search semantics of the
 implication is given by
\emph{back-chaining}.

\section{Polarization}
\LKF and \LJF ~\cite{LiaMil09}can accommodate both the $Q$ and $T$ protocols as well
as a mix of those protocols.
%
The proof system \LKF, for first-order classical logic, and the
proof system \LJF, for first-order intuitionistic logic, are
presented in Figures~\ref{fig:lkf} and~\ref{fig:ljf}, respectively.

In order to obtain their flexibility in capturing various focusing
regimes, the \LKF and \LJF proof systems use \emph{polarized}
formulas.
%
A \emph{polarized classical (first-order) formula} is a formula built
using atomic formulas, 
the usual first-order quantifiers $\forall$ and $\exists$, the implication
$\impl$, and polarized versions of the logical connectives and
constants, i.e., $\ntrue$, $\ptrue$,$\nfalse$, $\pfalse$, $\veen$,
$\veep$, $\wedgen$, $\wedgep$.
%
A \emph{polarized intuitionistic (first-order) formula} is a polarized
classical formula in which the logical connectives $\nfalse$ and
$\veen$ do not occur.
%
The positive and negative versions of connectives and constants
have identical truth conditions but different inference rules
inside the polarized proof systems.
%
For example, the left introduction rule for $\wedgep$ is invertible
while the left introduction rule for $\wedgen$ is not invertible.

%We shall also find it necessary to use \emph{delays}: if $B$ is a
%polarized formula then we define $\negd{B}$ to be (the always
%negative) $B\wedgen\ntrue$ and $\posd{B}$ to be (the always positive)
%$B\wedgep\ptrue$.
%%
%Equivalently, we can take $\posd{\cdot}$ to be the 1-ary version of
%either the binary $\veep$ or $\wedgep$ and
%take $\negd{\cdot}$ to be the 1-ary version of either
%the binary $\veen$ or $\wedgen$.
%%
%(The 0-ary version of these four connectives correspond to the
%logical units $\pfalse$, $\ptrue$, $\nfalse$, 
%%or 
%$\ntrue$.)

If a formula's top-level connective is $\ptrue$,
$\pfalse$, $\veep$, $\wedgep$, or $\exists$, then that formula is
\emph{positive}.
%
If a formula's top-level connective is $\ntrue$, $\nfalse$,
$\veen$, $\wedgen$, $\impl$, or $\forall$, then it is \emph{negative}.
%
Note that in the intuitionistic system \LJF, we have only one
disjunction and one falsum, both of which exist only with positive
polarity.
%
The way to form the negation of the polarized formula $B$ is with the
formula $B\impl\pfalse$: this formula has negative polarity no matter
the polarity of $B$.

%\ednote{MV: We said above that $\nfalse$ does not occur in the
%intuitionistic language. EP. I think that it should be $\pfalse$.} 

In both \LKF and \LJF, every polarized formula is classified as
positive or negative.
%
This means that we must also provide a polarity to atomic formulas.
%
As it turns out, this assignment of polarity to atomic formulas can,
in principle, be arbitrary.
%
%In particular, an \emph{atomic bias assignment} is a function
%$\bias{\cdot}$ that maps atomic formulas to the set of two tokens
%$\{pos,~neg\}$: if $\bias{A}$ is $pos$ then that atomic formula is
%positive and if $\bias{A}$ is $neg$ then that atomic formula is
%negative.
%%
%We may ask that all atomic formulas are positive, that
%they are all negative, or we can mix polarity
%assignments. 
%%
%In particular, the atomic bias assignment $\biasp{\cdot}$ assigns all
%atoms a positive polarity while $\biasn{\cdot}$ assigns all
%atoms a negative polarity.
%%
%We shall assume that an atomic bias
%assignment is also \emph{stable under substitution}: that is, for all
%substitutions $\theta$,  $\bias{\theta A} = \bias{A}$.
%%
%In first-order logic, this is equivalent to saying that such bias
%assignments are \emph{predicate determined}: that is, if atoms $A$ and
%$A'$ have the same predicate head, then $\bias{A}=\bias{A'}$.

%We say that the pair $\tup{\delta,\hat B}$ is a \emph{polarization of}
%$B$ if $\bias{\cdot}$ is an atomic bias assignment and if every
%occurrence of $\true$, $\wedge$, $\false$, and $\vee$ in $B$ is
%labeled with either the $+$ or $-$ annotation.
%%
%If $B$ has $n$ occurrences of these logical connectives then there are
%$2^n$ different ways to place these $+$ or $-$ symbols.
%%
%We shall also allow the insertion of any number of $\posd{\cdot}$ and
%$\negd{\cdot}$ into $\hat B$ as well.
%%
%In other words, the polarized formula $\tup{\delta,C}$ is a
%polarization of $B$ if deleting all delays and all $+$ and $-$
%annotations on logical connectives of $C$ results in $B$.
%
Note that we use $\impl$, $\forall$, and $\exists$ in both unpolarized
as well as polarized formulas: we can do this since the polarity of
these connectives is not ambiguous.
%
In classical logic, the polarity of $\true$, $\wedge$, $\false$, and
$\vee$ is ambiguous and all of these can be positive or negative.
%
In intuitionistic logic, only the polarity of $\true$ and $\wedge$
is ambiguous.
%
In both of these logics, however, the polarity of atoms is equally
ambiguous.
%
%Finally, if $\tup{\delta,\hat B}$ is a polarization of $B$, we shall
%generally drop explicit reference to $\delta$ and simply say that
%$\hat B$ is a polarization of $B$: often, the atomic bias assignment
%is either not important or can be inferred from context.


\subsection{Focused proof systems}
\label{sec:focused ps}


\begin{figure}
	{\sc Asynchronous Rules}
\[
  \infer[\kern-2pt\veen_r]{\jUnf{\Gamma}{\Sigma}{A \veen\kern-3pt B, \Omega}{\Delta}}
                 {\jUnf{\Gamma}{\Sigma}{A,B, \Omega}{\Delta}}   
  \qquad 
  \infer[\kern-2pt\wedgen_r]{\jUnf{\Gamma}{\Sigma}{A \wedgen B, \Omega}{\Delta}}
                   {\jUnf{\Gamma}{\Sigma}{A, \Omega}{\Delta}
                    & 
                    \jUnf{\Gamma}{\Sigma}{B, \Omega}{\Delta}}
\]
\[
  \infer[\wedgep_l]{\jUnf{\Gamma}{A\wedgep B,\Sigma}{\Omega}{\Delta}}
                   {\jUnf{\Gamma}{A , B, \Sigma}{\Omega}{\Delta}}
  \qquad
  \infer[\veep_l]{\jUnf{\Gamma}{A\veep B,\Sigma}{\Omega}{\Delta}}
                 {\jUnf{\Gamma}{A,\Sigma}{\Omega}{\Delta}
                  & 
                  \jUnf{\Gamma}{B,\Sigma}{\Omega}{\Delta}}
\]
\[
  \infer[\forall_r]{\jUnf{\Gamma}{}{\forall x.B, \Omega}{\Delta}}
                   {\jUnf{\Gamma}{}{[y/x]B, \Omega}{\Delta}}	
  \qquad
  \infer[\exists_l]{\jUnf{\Gamma}{\exists x.B, \Sigma}{\Omega}{\Delta}}
                   {\jUnf{\Gamma}{[y/x]B,\Sigma}{\Omega}{\Delta}}
\]
\[
  \infer[\kern-2pt\impl_r]{\jUnf{\Gamma}{\Sigma}{A \impl B, \Omega}{\Delta}}
                 {\jUnf{\Gamma}{\Sigma,A}{B,\Omega}{\Delta}}
  \qquad
  \infer[\kern-2pt\ptrue_l]{\jUnf{\Gamma}{\ptrue\kern-2pt, \Sigma}{\Omega}{\Delta}}
                  {\jUnf{\Gamma}{\Sigma}{\Omega}{\Delta}}
  \qquad
  \infer[\kern-2pt\nfalse_r]{\jUnf{\Gamma}{\Sigma}{\nfalse\kern-2pt,\Omega}{\Delta}}
                            {\jUnf{\Gamma}{\Sigma}{\Omega}{\Delta}}
\]
\[
  \infer[\ntrue_r]{\jUnf{\Gamma}{\Sigma}{\ntrue\kern-3pt,\Omega}{\Delta}}{}
  \qquad
  \infer[\kern-2pt\pfalse_l]{\jUnf{\Gamma}{\pfalse\kern-2pt,\Sigma}{\Omega}{\Delta}}{}
\]
	
\medskip{\sc Synchronous Rules}	

\[ 
  \infer[\impl_l]{\jLf{\Gamma}{A\impl B}{\Delta}}
                 {\jRf{\Gamma}{A}{\Delta} &  \jLf{\Gamma}{B}{\Delta}}
  \quad	
  \infer[\veen_l]{\jLf{\Gamma}{A \veen\kern-3pt B}{\Delta}}
                 {\jLf{\Gamma}{A}{\Delta}
                  & 
                  \jLf{\Gamma}{B}{\Delta}}
  \quad
  \infer[\kern -2pt\wedgen_l]{\jLf{\Gamma}{A_1 \wedgen\kern-3pt A_2}{\Delta}}
                   {\jLf{\Gamma}{A_i}{\Delta}}
\]
\[
  \infer[\wedgep_r]{\jRf{\Gamma}{A \wedgep B}{\Delta}}
                   {\jRf{\Gamma}{A}{\Delta}
                    & 
                    \jRf{\Gamma}{B}{\Delta}}
  \qquad
  \infer[\veep_r]{\jRf{\Gamma}{A_1 \veep A_2}{\Delta}}
                 {\jRf{\Gamma}{A_i}{\Delta}}
\]
\[
  \infer[\forall_l]{\jLf{\Gamma}{\forall x.B}{\Delta}}
                   {\jLf{\Gamma}{[t/x]B}{\Delta}}
  \quad
  \infer[\exists_r]{\jRf{\Gamma}{\exists x.B}{\Delta}}
                   {\jRf{\Gamma}{[t/x]B}{\Delta}}
  \quad
  \infer[\ptrue_r]{\jRf{\Gamma}{\ptrue}{\Delta}}{}
  \quad
  \infer[\nfalse_l]{\jLf{\Gamma}{\nfalse}{\Delta}}{}
\]

\medskip{\sc Identity rules}
	
\[
  \infer[\kinit_l]{\jLf{\Gamma}{N_a}{N_a, \Delta}}{}
  \qquad
  \infer[\kinit_r]{\jRf{\Gamma,P_a}{P_a}{\Delta}}{}
%	\qquad 
%	\infer[cut]{\jUnf{\Gamma}{}{}{\Delta}}
%	{\jUnf{\Gamma}{}{F}{\Delta}
%	& 
%	\jUnf{\Gamma}{F}{}{\Delta}}
\]
	
\medskip{\sc Structural rules}
	
\[
  \infer[\kdecide_l]{\jUnf{\Gamma,N}{}{}{\Delta}}
                    {\jLf{\Gamma,N}{N}{\Delta}}
  \quad
  \infer[\kdecide_r]{\jUnf{\Gamma}{}{}{P, \Delta}}
                    {\jRf{\Gamma}{P}{P, \Delta}}
  \quad
  \infer[\krelease_l]{\jLf{\Gamma}{P}{\Delta}}
                     {\jUnf{\Gamma}{P}{}{\Delta}}
  \quad
  \infer[\krelease_r]{\jRf{\Gamma}{N}{\Delta}}
                     {\jUnf{\Gamma}{}{N}{\Delta}}
\]
\[
  \infer[\kstore_l]{\jUnf{\Gamma}{C,\Sigma}{\Omega}{\Delta}}
                   {\jUnf{C,\Gamma}{\Sigma}{\Omega}{\Delta}}
  \qquad
  \infer[\kstore_r]{\jUnf{\Gamma}{}{D, \Omega}{\Delta}}
                   {\jUnf{\Gamma}{}{\Omega}{D, \Delta}}
\]
	
Here, $P$ is positive, $N$ is negative, $C$ is a negative formula or
positive atom, $D$ a positive formula or negative atom, $N_a$ is
a negative atom, and $P_a$ is a positive atom.  Other formulas
are arbitrary. In the rules $\forall_r$  and $\exists_l$ the
eigenvariable $y$ does not occur free in any formula of the
conclusion.
\caption{The focused classical sequent calculus \LKF.}
\label{fig:lkf}
\end{figure}	

\begin{figure}
{\sc Asynchronous Rules}

\[
  \infer[\impl_r]{\jUnfG{\Sigma}{A \supset B}}{\jUnfG{A,\Sigma}{B}}   
  \qquad
  \infer[\wedgen_r]{\jUnfG{\Sigma}{A \wedgen B}}
                   {\jUnfG{\Sigma}{A} \quad \jUnfG{\Sigma}{B}}
\]
\[
  \infer[\wedgep_l]{\jUnfGamb{A\wedgep B,\Sigma}}{\jUnfGamb{A , B, \Sigma}}
  \qquad
  \infer[\veep_l]{\jUnfGamb{A\veep B,\Sigma}}
        {\jUnfGamb{A,\Sigma}\quad \jUnfGamb{B,\Sigma}}
\]
\[
  \infer[\forall_r]{\jUnfG{\Sigma}{\forall x.B}}{\jUnfG{\Sigma}{[y/x]B}}
  \qquad
  \infer[\exists_l]{\jUnfGamb{\exists x.B, \Sigma}}{\jUnfGamb{[y/x]B,\Sigma}}
 \]
\[
  \infer[\ntrue_r]{\jUnfG{\Sigma}{\ntrue}}{}\qquad
  \infer[\ptrue_l]{\jUnfGamb{\ptrue, \Sigma}}{\jUnfGamb{\Sigma}}
   \qquad
  \infer[\pfalse_l]{\jUnfGamb{\pfalse, \Sigma}}{}
\]

\medskip{\sc Synchronous Rules}

\[ 
  \infer[\impl_l]{\jLfG{A \impl B}}{  \jRfG{A}\quad \jLfG{B}}
  \qquad
  \infer[\veep_r]{ \jRfG{A_1 \veep A_2}}{\jRfG{A_i}}
  \qquad
  \infer[\wedgen_l]{\jLfG {A_1 \wedgen A_2}}{\jLfG{A_i}}
\]
\[
  \infer[\wedgep_r]{\jRfG{A \wedgep B}}{\jRfG{A} \quad \jRfG{B}}
  \quad
  \infer[\forall_l]{\jLfG{\forall x.B}}{\jLfG{[t/x]B}}
  \quad
  \infer[\exists_r]{\jRfG{\exists x.B}}{\jRfG{[t/x]B}}
  \quad
  \infer[\ptrue_r]{\jRfG{\ptrue}}{}
\]

\medskip{\sc Identity rules}

\[
  \infer[\kinit_l]{\jLf{\Gamma}{N_a}{N_a}}{}
  \qquad
  \infer[\kinit_r]{\jRf{\Gamma,P_a}{P_a}}{}
  \qquad
%  \infer[cut]{\jUnf{\Gamma}{}{}{R}}
%             {\jUnf{\Gamma}{}{F}{}\qquad \jUnf{\Gamma}{F}{}{R}}
\]

\medskip{\sc Structural rules}

\[
  \infer[\kern -2pt \kdecide_l]{\jUnf{\Gamma,N}{}{}{R}}{\jLf{\Gamma,N}{N}{R}}
  \quad
  \infer[\kern -2 pt \kdecide_r]{\jUnf{\Gamma}{}{}{P}}{\jRf{\Gamma}{P}}
  \quad
  \infer[\krelease_l]{\jLf{\Gamma}{P}{R}}{\jUnf{\Gamma}{P}{}{R}}
  \quad
  \infer[\krelease_r]{\jRf{\Gamma}{N}}{ \jUnf{\Gamma}{}{N}{}}
\]
\[
\infer[\kstore_l]{\jUnfamb{\Gamma}{C,\Sigma}{}}
                 {\jUnfamb{C,\Gamma}{\Sigma}{}}
  \qquad
  \infer[\kstore_r]{\jUnf{\Gamma}{}{D}{}}{\jUnf{\Gamma}{}{}{D}}
\]

Here, $P$ is positive, $N$ is negative, $C$ is a negative formula or
positive atom, $D$ a positive formula or negative atom, $N_a$ is a
negative atom, and $P_a$ is a positive atom.  Other formulas are
arbitrary. $\Rscr$ denotes $\Delta_1 \Uparrow \Delta_2$ where the
union of $\Delta_1$ and $\Delta_2$ contains at most one formula.  
In the rules $\forall_r$  and $\exists_l$ the
eigenvariable $y$ does not occur free in any formula of the
conclusion.
\caption{The focused intuitionistic sequent calculus \LJF.}
\label{fig:ljf}
\end{figure}	

The inference rules of \LKF and \LJF presented in Figures~\ref{fig:lkf} and~\ref{fig:ljf}, respectively, involve three kinds of sequents 
\begin{itemize}
\item $\jUnf{\Gamma}{\Sigma}{\Omega}{\Delta}$ belongs to the {\em asynchronous phase}. During this phase, all negative (resp. positive) formulas in  $\Omega$ (resp. $\Sigma$) are introduced and all atoms and positive (resp. negative) formulas  are stored in the context $\Delta$ (resp. $\Gamma$);
\item $\jLf{\Gamma}{B}{\Delta},\quad\hbox{and}\quad
  \jRf{\Gamma}{B}{\Delta}$ belongs to the {\em synchronous phase}, where all positive connectives at the root of $B$ are introduced. 
\end{itemize}
Here $\Gamma$, $\Sigma$, $\Omega$ and $\Delta$ are
multisets of polarized formulas and $B$ is a polarized formula.
%
The formula occurrence $B$ in a $\Downarrow$-sequent is called the
\emph{focus} of that sequent.

The dynamics of the different phases is detailed below.

\noindent
{\bf Asynchronous Phase.} Asunchronous rules can be applied eagerly, in any order.
This process includes storing formulas: note that the rules $\kstore_r, \kstore_l$ move, to the 
contexts $\Gamma/\Delta$, atomic or negative/positive formulas since they cannot be decomposed during the asynchronous phase.

The asynchronous phase ends when $\Sigma,\Omega$ in unfocused sequents are empty. A decision rule $\mathsf{D_l}$ or  $\mathsf{D_r}$ is then applied,  and
a synchronous phase starts by {\em focusing} on a non-atomic formula, either negative on the left or positive on the right.

\noindent
{\bf Synchronous Phase.} Once we focus on a formula, the proof  follows by applying synchronous rules, where  the focus persists on the decomposed subformulas until either: the proof ends with an instance of an axiom;
a negative (resp. positive) formula  on the right (resp. left) is reached, and the synchronous phase  ends with the application of one of the release rules $\krelease_r,\krelease_l$.


There are two initial rules, $\kinit_r,\kinit_l$, acting on right positive atoms and left negative atoms, respectively, meaning that derivations should necessarily end when focusing on such formulas.


The system  \LJF is depicted in a separate figure for the sake of clarity.
%
However, one can notice that, similarly to what we have for \LJ and
\LK in the original Gentzen formulations, \LJF can be seen as a
restriction of \LKF, where the rules for $\nfalse$ and $\veen$ are
omitted and only one formula is admitted in the succedent of sequents.  In
particular, this implies that $(i)$ in the left rule for $\impl$, the
right context of the conclusion is not present in the left premise;
$(ii)$ in the rule $\kdecide_r$, the formula placed under focus is
not subjected to contraction; and $(iii)$ a sequent of the form $\jRf{\Gamma}{B}{\Delta}$, when used in an
\LJF proof, is such that $\Delta$ is empty.
%
In that case, we write that sequent as simply $\jRf{\Gamma}{B}{}$.



\section{Axioms to rules: bipoles}\label{sec:bipol}
In~\cite{DBLP:journals/apal/MarinMPV22} we have presented a process of transforming (polarized) bipolar axioms into rules in the
classical/intuitionistic settings. 
The idea is that bipolars force a unique {\em shape} in focused derivations (called {\em bipoles}), where only atoms are stored in the leaves.
Bipoles then {\em justifies} a synthetic inference rule for the respective bipolar.\footnote{While it should be noted that a bipolar can give rise to different bipoles, they do not differ in their {\em shape}.}

We will illustrate the process with an example.
\begin{example}\label{ex:bipole}
Let $R(x,y)$ be a {\em negative} atomic
formula and assume that the polarized formula $\forall x,y. R(x,y)\iimp R(y,y) $ is a member of
$\Gamma$.
%
Consider the following \LKF derivation 
\[
  \infer[\kdecide_l]{\jUnf{\Gamma}{}{}{\Delta}}{
  \infer[\forall_l]{\jLf{\Gamma}{\forall x,y. R(x,y)\iimp R(y,y)}{\Delta}}
 {\infer[\impl_l]{\jLf{\Gamma}{R(x,y)\iimp R(y,y) }{\Delta}}
  {\infer[\krelease_r]{\jRf{\Gamma}{R(x,y)}{\Delta}}
   {\infer[\kstore_r]{\jUnf{\Gamma}{}{R(x,y)}{\Delta}}
   {\deduce{\jUnf{\Gamma}{}{}{\Delta,R(x,y)}}{}}}
   & 
   \infer[\kinit_l]{\jLf{\Gamma}{R(y,y)}{\Delta}}
  {}}}}
\]	
%
In order to apply the rule $\kinit_l$ in this derivation, it must be
the case that $R(y,y) \in\Delta$, that is, $R(y,y)$ is in the conclusion sequent. The atomic predicate $R(x,y)$ appear stored in the leaf, so it is in the premis. 
%
This derivation justifies the following (unfocused) synthetic inference rule in \LK,
on unpolarized formulas % computed by this synthetic rule 
\[
  \infer[kt_n]{\Gamma\seq \Delta, R(y,y)}
        {\Gamma\seq \Delta, R(x,y)}	
\]
If, however, the polarity of $R$ is {\em positive}, then the following (unfocused) synthetic inference rule in \LK\ will be derived
\[
  \infer[kt_p]{\Gamma,R(x,y)\seq \Delta}
        {\Gamma, R(y,y)\seq \Delta}	
\]

\end{example}

\section{Beyond bipoles: 2-systems}
Consider the axiom $\neg \alpha\vee\neg\neg\alpha$
and its polarized atomic version $\negd{\neg P \veep \neg\neg P}$ with $P$ positive,
where $\negd{B}$ denotes (the always
negative formula) $B\wedgen\ntrue$, and $\neg B=B\impl \pfalse$,  for any
polarized formula $B$. The focused derivation in \LJF\ corresponding to this axiom is
\[
\infer={\jLf{\Gamma}{\negd{\neg P \veep \neg\neg P}}{C}}
{\infer[\veep_l]{\jUnf{\Gamma}{\neg P \veep \neg\neg P}{}{C}}
{\infer[\kstore_l]{\jUnf{\Gamma}{\neg P}{}{C}}
{\deduce{\jUnf{\Gamma,\neg P}{}{}{C}}{\pi_1}}
&
\infer[\kstore_l]{\jUnf{\Gamma}{\neg\neg P}{}{C}}
{\deduce{\jUnf{\Gamma,\neg\neg P}{}{}{C}}{\pi_2}}}}
\]
Since neither $\neg P$ nor $\neg\neg P$ are atomic formulas, this derivation does not correspond to an inference rule on atoms. And forcing a second focus step over such formulas in any of the continuations $\pi_i$ may turn the resulting system unsound. 

This means that, in a possible derivation, it may be the case that $\neg P,\neg\neg P$ are used or not. If they are, then $\pi_1,\pi_2$ have the following shapes, respectively
\[
\deduce{\jUnf{\Gamma,\neg P}{}{}{C}}
{\deduce{\vdots}
{\infer={\jLf{\Gamma_1}{\neg P}{C_1}}
{\infer{\jRf{\Gamma_1}{P}{}}{}}}}
\qquad
\deduce{\jUnf{\Gamma,\neg\neg P}{}{}{C}}
{\deduce{\vdots}
{\infer={\jLf{\Gamma_2}{\neg\neg P}{C_2}}
{\deduce{\jUnf{\Gamma_2,P}{}{}{}}{}}}}
\]
This means that $P\in\Gamma_1$ and the derivations together would justify the system of rules
\[
\infer[r]{\Gamma\vdash C}
      {\deduce{\Gamma\vdash C\strut}
              {\deduce{\vdots}
                      {\infer[r_1]{\Gamma_1,P\vdash }{}}}\quad&\quad
       \deduce{\Gamma\vdash C\strut}
              {\deduce{\vdots}
                      {\infer[r_2]{\Gamma_2\vdash C_2}
                             {\deduce{\Gamma_2,P\vdash }{}}}}}
\]
That is, the rules $r_i$ may be applied, with the condition that $r$ should have been already applied, in a bottom-up reading of rules. This has a natural deduction flavor, when rules carry on some information of derivations, like the {\em discharging of formulas}.

The {\em
systems of rules}~\cite{Neg16} is an extension of the \emph{axioms-as-rules
formalism}, since it allows for different sequent rules connected by
conditions on the order of their applicability and with the possibly
of sharing meta-variables for formulas or sets of formulas.
%

We observe, however, the method presented in~\cite{Neg16}  only applies to a class of
generalized geometric implications, and $\neg \alpha\vee\neg\neg\alpha$ does not fall into this class. As shown in~\cite{DBLP:journals/apal/MarinMPV22}, polarities and focusing generalize the approaches based on geometric axioms.

In~\cite{DBLP:journals/tocl/CiabattoniG18}, Ciabattoni and Genco also presented a general view of two-level system of rules, called 2-systems. We present next a polarized version of 2-systems.
\begin{definition}
A  {\em polarized 2-system} is a set of sequent rules $\{(r_1), . . . , (r_k ), (r)\}$ that can only be applied according to the following schema
\[
\infer[r]{\Gamma\vdash C}
      {\deduce{\Gamma\vdash C\strut}
              {\deduce{\vdots}
                      {\pi_1}}\quad\ldots\quad
       \deduce{\Gamma\vdash C\strut}
              {\deduce{\vdots}
                      {\pi_k}}}
\]
where each derivation $\pi_i$, for $1\leq i \leq k$ may contain several applications of
\[
\infer[r_i]{S_i}
{S_{i_1}\qquad\ldots\qquad S_{i_{n_i}}}
\]
where $S_i,S_{i_j}$ are sequents that act on the same multisets of (atomic) formulas, $1\leq i\leq k, 1\leq j\leq n_i$. 
\end{definition}
\begin{example}
If $N$ is a negative atom in $\negd{\neg N \veep \neg\neg N}$, then the correspondent polarized 2-system is 
\[
\infer[r]{\Gamma\vdash C}
      {\deduce{\Gamma\vdash C\strut}
              {\deduce{\vdots}
                      {\infer[r_1]{\Gamma_1\vdash C_1}{\Gamma_1\vdash N}}}\quad&\quad
       \deduce{\Gamma\vdash C\strut}
              {\deduce{\vdots}
                      {\infer[r_2]{\Gamma_2\vdash C_2}
                             {\deduce{\Gamma_2,N\vdash }{}}}}}
\]
\end{example}
The next example is the well known \emph{linearity axiom} $(\varphi\to \psi)\vee (\psi\to \varphi)$.
\begin{example}\label{ex:linearity}
Instantiated to positive atomic formulas $P,Q$  the linearity axiom becomes $\delayop^-[(P\impl Q)\veep (Q\impl P)]$. It gives rise to the polarized 2-system 
\[
\infer{\Gamma\vdash C}
      {\deduce{\Gamma\vdash C\strut}
              {\deduce{\vdots}
                      {\infer{\Gamma_1,P\vdash C_1}{\Gamma_1,P,Q\vdash C_1}}}\quad&\quad
       \deduce{\Gamma\vdash C\strut}
              {\deduce{\vdots}
                             {\infer{\Gamma_2,Q\vdash C_2}{\Gamma_2,Q,P\vdash C_2}}}}
\]
\end{example}
\begin{claim} Polarized 2-systems correspond to the class of
$\mathcal{N}_4$ formulas.
\end{claim}

\section{From to 2-systems to hypersequents}
In~\cite{DBLP:journals/tocl/CiabattoniG18} a method transforming 2-systems into hypersequents (and vice-versa) was presented. The general idea is the following
\begin{itemize}
\item[$\Rightarrow$] The conclusion sequents $S_i$ are joined in the same conclusion hypersequent and the premises are extended to the hypersequent formulation
\[
\infer[hr]{G\mid S_1\mid \ldots \mid S_k}
{M_1 \ldots M_k}
\]
where $M_i$ is the multiset of premises $G\mid S_{i_j}$, for $1\leq j\leq n_i, 1\leq i\leq k$.
\item[$\Leftarrow$] Consider the hypersequent rule $hr$ where the sets $M_i, 1 \leq i \leq k$ constitute a partition of the set of premisses of $hr$ and each $M_i$ contains the premisses $S_{i_j}, 1\leq j\leq n_i$. The corresponding polarized 2-system is
\[
\infer[r]{\Gamma\vdash C}
      {\deduce{\Gamma\vdash C\strut}
              {\deduce{\vdots}
                      {\pi_1}}\quad\ldots\quad
       \deduce{\Gamma\vdash C\strut}
              {\deduce{\vdots}
                      {\pi_k}}}
\]
where each derivation $\pi_i$, for $1\leq i \leq k$ may contain several applications of
\[
\infer[r_i]{S_i}
{S_{i_1}\qquad\ldots\qquad S_{i_{n_i}}}
\]
where $S_i,S_{i_j}$ are sequents that act on the same multisets of (atomic) formulas, $1\leq i\leq k, 1\leq j\leq n_i$. %\red{EP. I find this highly non-deterministic!}
\end{itemize}
\begin{example}
The polarized 2-system given in Example~\ref{ex:linearity} is transformed 
into the hypersequent rule
\[
\infer[com]{G\mid P,\Gamma_1\vdash C_1\mid Q,\Gamma_2\vdash C_2}
{G\mid P,Q,\Gamma_1\vdash C_1 & G\mid  P,Q,\Gamma_2\vdash C_2}
\]
\end{example}
Observe that all the sequent/hypersequent/system of rules manipulate atomic formulas only, such as in the case for labelled systems arising from frame conditions. Hence the resulting systems are not ``general'', as the ones considered, \eg in~\cite{DBLP:conf/lics/CiabattoniGT08}. This has some consequences, for example, it does not seem possible to expand the analyticity proofs in~\cite{DBLP:journals/apal/MarinMPV22} to {\em axiom schemata} -- also it is not clear what {\em polarization} would be in the general case. The same happens in all the works concerning geometric axioms and extensions~\cite{NegVPl98,Neg03,Neg16,negri19}.

As suggested in~\cite{DBLP:journals/tocl/CiabattoniG18}, and for all propositional Hilbert axioms within the class $\mathcal{P}_3$, analyticity for the {\em general} 2-systems (\ie\ not restrict to atoms) can be recovered by (a) first translating them into hypersequent rules, (b) applying the completion procedure in~\cite{DBLP:conf/lics/CiabattoniGT08} to the latter, and (c) translating them back. 

\magenta{EP. I am not sure how this would work in a polarized setting... It should be observed, however, that Negri's 2-systems and Ciabattoni's (hyper)systems can be justified by polarized formulas in $\mathcal{N}_4$ (claim) when atoms have positive polarity.}

\section{A labeled system for $\KTb$}
The modal logic $\KTb$ is `one step away' from  $\K\T$ in the sense that in any shift-reflexive (Euclidean) frame the subframe induced by all worlds reachable from some fixed world is reflexive (totally connected)~\cite{DBLP:conf/tableaux/Lang23}. Hence a labeled system for $\KTb$ would be the system depicted in Figure~\ref{fig:labk} for $\K$ plus the rule $kt_p$ in Section~\ref{sec:bipol}, for example.

\begin{figure}[t]%\scriptsize
{\sc Initial rule}
\[
  \infer[\init]{{x:P,\Gamma}\vdash{\Delta, x:P}}{}
%  \qquad
%  \infer[\initR]{{x \rel y, \Gamma}\vdash{\Delta, x\rel y}}{}
\]
{\sc Structural rules}	
\[
  \infer[C_l]{\varphi, \Gamma \vdash \Delta}{\varphi, \varphi, \Gamma \vdash \Delta}
  \qquad
  \infer[C_r]{\Gamma \vdash \Delta, \psi}{\Gamma \vdash \Delta, \psi, \psi}
\]
{\sc Propositional rules}
\[
  \infer[\lwedge_1]{x:A\wedge B, \Gamma \vdash \Delta}{x:A, \Gamma \vdash \Delta}
  \quad
    \infer[\lwedge_2]{x:A\wedge B, \Gamma \vdash \Delta}{x:B, \Gamma \vdash \Delta}
 \quad
  \infer[\rwedge]{\Gamma \vdash \Delta, x:A \wedge B}{\Gamma \vdash \Delta, x:A & \Gamma \vdash \Delta, x:B}	
\]
\[
  \infer[\lvee]{x:A\vee B, \Gamma \vdash \Delta}{x:A,\Gamma \vdash \Delta & x:B,\Gamma \vdash \Delta}
  \quad
  \infer[\rvee_1]{\Gamma \vdash \Delta, x:A \vee B}{\Gamma \vdash \Delta, x:A}
  \quad
  \infer[\rvee_2]{\Gamma \vdash \Delta, x:A \vee B}{\Gamma \vdash \Delta, x:B}
\]
\[
  \infer[\limpl]{x:A\impl B, \Gamma \vdash \Delta_1,\Delta_2}{\Gamma \vdash \Delta_1, x:A & x:B,\Gamma \vdash \Delta_2}
  \qquad
  \infer[\rimpl]{\Gamma \vdash \Delta, x:A \impl B}{x:A, \Gamma \vdash \Delta, x:B}
\]
\[
  \infer[f]{x:f, \Gamma \vdash \Delta}{}
  \qquad
  \infer[t]{\Gamma \vdash \Delta,x:t}{}
\]
{\sc Modal rules}
\[
  \infer[\rbox]{\Gamma \vdash \Delta, x:\square A}{x \rel y, \Gamma \vdash \Delta, y:A} \qquad
  \infer[\lbox]{x \rel y,x:\Box A, \Gamma \vdash \Delta}{x \rel y, y:A,\Gamma \vdash \Delta}
\]
\caption{Labeled system for the modal logic $\K$. $P$ is an atomic formula
  and the eigenvariable $y$ does not occur free in any formula of the
  conclusion of rule $\rbox$.}
\label{fig:labk}
\end{figure}	

\subsection{A possible roadmap}
\begin{enumerate}
\item It is easy to show that the rules $\rbox,\lbox$ ``simulate'' the rule 
\[
\infer[\K]{\Box\Gamma\seq\Box A}{\Gamma\seq A}
\]
This is formally stated in~\cite{DBLP:conf/tableaux/PimentelRL19}. It would be interesting to simulate the 2-system
with the rule
\[
\infer[\K]{\Box\Gamma\seq\Box A}
{\deduce{\Gamma\seq A}
{\deduce{\vdots}
{\infer[\T]{\Box B,\Gamma',\seq\Delta'}{B,\Gamma',\seq\Delta'}}}}
\]
I think this is not difficult, in fact.
\item I am not sure it is possible to extend the work in~\cite{DBLP:journals/tocl/CiabattoniG18} to modalities. If it is, then we could translate directly the 2-system into hypersequents.
\item  In any case, it would be interesting to see if it is possible to extend Ciabattoni's ideas to the first-order case. Not sure how this would help here, but in any case it could be interesting.
\item  I have some other ideas of applications of all that to the ecumenical setting, if someone is interested.
\end{enumerate}

\bibliography{biblio}
\end{document}

